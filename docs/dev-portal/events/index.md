---
title: Event
layout: default
---
#Contextual Engine

##EVENT

Sensors in modern devices generate a lot of data which ContextHub packages today into an event. The event data structure contains keys about the event which you can use in context rules to create advanced processing on the ContextHub server. All events have a very basic structure with 6 important keys: 

- `name` - The name of the event which will determine the context rule(s) to be executed
- `data` - The data from the event specific to the event type (pre-defined events have pre-defined structures, see below for more info)
	- `datetime` - Every pre-defined event will have an ISO 8601 timestamp indicating when the event was triggered by the device.
- `context` - Context represents data about the device which generated the event
	- `device_context` - Basic data about the device: model, type, OS version, and device id
	- `geofence_context` - A list of geofences the device was last in when the event occurred
	- `location_context` - Basic location data about the device when the event occured
	- `ranged_beacons_context` - A list of specific beacons in range of the device when the event occured
- `payload` - Developer-defined custom data sent along with every event generated by the ContextHub SDK.
- `id` - A unique 32-hexadecimal character string displayed in five groups separated by hyphens, in standardized UUID/GUID format (`8-4-4-4-12`)
- `created_at` - An IOS 8601 timestamp created when the event was created on the server.
<br />
<br />

###Sample Event

Here is the structure of a sample event:
{% gist CHLibrarian/18c01d70d2448bfec465 %}
<br />

###Beacon In/Out

The `beacon_in`/`beacon_out` event is generated whenever a device enters or exits a beacon region. A beacon region is defined as a UUID + major/minor values, if provided. If not provided, then several beacons having the same UUID will only trigger a `beacon_in` event once. Inside the `data` key, there is a `beacon` key indicating the beacon region which was just entered/exited and the UUID for the beacon region. Major and minor values will be filled only if the monitored region in ContextHub has them (they are not required). To get events about specific beacons, specifically `state` and `accuracy` values, look at `beacon_changed`.

{% gist CHLibrarian/4124b79edcc0e6969f8d %}
<br />

### Beacon Changed

The `beacon_changed` event is generated whenever a device changes proximity of a *specific* beacon. There are three pre-defined states, `immediate_state`, `near_state`, and `far_state` which are approximately 0-6 inches, 6-12 inches, and 12 inches - 50 feet depending on the range and power setting of the particular beacon used. Within the `beacon` key of the `data` key, you will find the specific `major` and `minor` values of the beacon, as well as the `rssi` value giving relative strength. Estimote explains very well [here](https://community.estimote.com/hc/en-us/articles/201029223-RSSI-Range-Zones-and-Distance-Accuracy) RSSI values and how they relate to distance between a device an a beacon. `accuracy` is also another key present which gives the approximate distance from the beacon to the device. Given the number of factors that influence wireless signals in an area, the accuracy value should be used as a general guideline, and not relied on in critical scenarios.

{% gist CHLibrarian/4768b16d3e6a1b95785d %}
<br />

###Geofence In/Out

The `geofence_in`/`geofence_out` is generated whenever a device enters or exists a circular geofence region. A geofence region is defined as a geospatial center with latitude and longitude, and radius in meters. Inside the `data` key, there is a `fence` key indicating the geofence region which was just entered/exited along with the latitude, longitude, and radius of the geofence. The `state` key determines whether the event was a `geofence_in` or `geofence_out` event.
{% gist CHLibrarian/9d4439ed9ed94720514f %}
<br />

###Location Changed

The `location_changed` event is generated whenever a device has a significant location change as defined by the platform. For iOS, this is approximately once every 1000 meters, depending on WiFi/cellular tower density and GPS availability. The `data` structure contains keys related to the `latitude`, `longitude`, `speed`, `altitude`, and `course` of the device at the time the event was generated.

{% gist CHLibrarian/33148acb910e8c3c31d2 %}
<br />

<!-- 
###Motion Changed

The `motion_changed` event is generated whenever an iOS device with the M7 chip transitions between various states representing different modes of transportation: `stationary`, `walking`, `running`, and `driving`. The `data` key contains two keys (`current_activity` and `previous_activity`) representing the current and previous activities respectively along with a `start_date` timestamp and `confidence` key representing how confident the M7 is that the state of the activity is accurate.

{% gist CHLibrarian/ea17579eb481ac658a36 %}
<br />
-->

### Tick

The `tick` event is a special event that is automatically executed once every minute in the ContextHub server. Using the JavaScript `Date()` object and checking the time, this allows you the ability to execute commands in ContextHub even with the *absence* of any events on the server. So instead of your server code simply being reactive to devices, it can be a proactive part of your applications.

{% gist CHLibrarian/109cad3805c2650fe9f0 %}
<br />

###Custom Events

Custom events are events triggered by the developer that have no predefined data structure. These events are manually triggered by the SDK through a specific method, or by posting an event through a feed for web browsers, servers, JavaScript scripts, and IoT-like devices like the Raspberry Pi or Arduino. All custom events must have a defined `name` key, so they can be processed by the appropriate context rule if it exists and should have the `data` key representing your custom data structure. Custom events generated by non-SDK devices, will not have either the `context` or `payload` unless they are defined by you, the application developer. 

Below is a sample of a data structure of a custom event, taken from the [Awareness](/samples/ios/awareness) context rule sample app.

{% gist CHLibrarian/57a43d174de887c0b778 %}
<br />
